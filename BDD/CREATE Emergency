CREATE DATABASE emergency
    WITH 
    OWNER = postgres
    ENCODING = 'UTF8'
    LC_COLLATE = 'French_France.1252'
    LC_CTYPE = 'French_France.1252'
    TABLESPACE = pg_default
    CONNECTION LIMIT = -1;

CREATE SCHEMA public
    AUTHORIZATION postgres;

CREATE SCHEMA fireworker
    AUTHORIZATION postgres;
	
CREATE TABLE fireworker.trucks
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    id_barrack integer NOT NULL,
    longitude integer,
    latitude integer,
    CONSTRAINT trucks_pkey PRIMARY KEY (id)
);
	
CREATE TABLE fireworker.barracks
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    longitude integer,
    latitude integer,
    CONSTRAINT barrack_pkey PRIMARY KEY (id)
);

CREATE TABLE public.sensors
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    sensor_column integer NOT NULL,
    sensor_line integer NOT NULL,
    longitude integer,
    latitude integer,
    intensity integer NOT NULL,
    CONSTRAINT sensors_pkey PRIMARY KEY (id)
);

CREATE TABLE public.fires
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    date timestamp without time zone NOT NULL,
    longitude integer NOT NULL,
    latitude integer NOT NULL,
    intensity integer,
    CONSTRAINT fires_pkey PRIMARY KEY (id)
);

CREATE TABLE public.sensors__fires
(
    id_sensor integer NOT NULL,
    id_fire integer NOT NULL,
    CONSTRAINT sensors__fires_pkey PRIMARY KEY (id_sensor, id_fire),
    CONSTRAINT fires FOREIGN KEY (id_fire)
        REFERENCES public.fires (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT sensors FOREIGN KEY (id_sensor)
        REFERENCES public.sensors (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
);

CREATE TABLE fireworker.missions
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    id_fire integer NOT NULL,
    id_truck integer NOT NULL,
    date date NOT NULL,
    CONSTRAINT missions_pkey PRIMARY KEY (id, id_fire, id_truck, date),
    CONSTRAINT fires FOREIGN KEY (id_fire)
        REFERENCES public.fires (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT truck FOREIGN KEY (id_truck)
        REFERENCES fireworker.trucks (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
);